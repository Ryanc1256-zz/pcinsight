<!doctype html>
<html>
	<head>
		<title> Admin </title>
		<meta charset="utf-8" />
		<link rel="stylesheet" type="text/css" href="resources/css/main.css" />
		<link rel="stylesheet" type="text/css" href="resources/css/font-awesome.css" />
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
		<script src="resources/flot/flot.min.js"></script>		
		<script src="resources/ckeditor/ckeditor.js"></script>
		<script src="resources/ckeditor/adapters/jquery.js"></script>
		<!--[if lt IE 9]>
			<script src="resources/flot/excanvas.min.js"></script>
		<![endif]-->
		<script>
			var ResizeID;
			
			
			$(document).ready(function(){
				$("#leftNav").css('height', ($(document).height() - 40));
				
				var toggled = false;
				$(".menu.menu-expand.toggle.btn").click(function(){
					if (!toggled) {
						$("#leftNav .submenu.toggled").slideUp().removeClass('toggled');
						$("#leftNav").animate({
							width: '40px'
						}, {queue: false});
						$("#leftNav span").hide();
						
						toggled = true;
						$("#innerContentWrapper").animate({
							width: ($(window).width() - 40)
						}, {queue: false});
					}
					else
					{
						$("#leftNav").animate({
							width: '251px'
						}, {
							complete: function(){
								$("#leftNav span").show();
							}
						});
						
						$("#innerContentWrapper").animate({
							width: ($(window).width() - 251)
						}, {queue: false});
						
						toggled = false;
					}
				});
				
				$("body").click(function(e){
					if (!($(e.target).hasClass('dropdown') || $(e.target).parent().hasClass('dropdown') || $(e.target).parent().parent().parent().hasClass('dropdown') || $(e.target).parent().parent().hasClass('dropdown') || $(e.target).hasClass('profilePic') || $(e.target).parent().hasClass('profilePic'))){
						$("nav .dropdown").hide();
					}
					
					var check = $(e.target).hasClass('notificationbar') || $(e.target).parent().parent().hasClass('notificationbar') || $(e.target).attr('id') == 'notifications' || $(e.target).parent().attr('id') == 'notifications';				
					if (!check){
						$(".notificationbar").hide();
					}				
				});
				
				$("#leftNav li").click(function(e){					
					if ($(this).children('ul').hasClass('submenu'))
					{
						e.preventDefault();
						if (!$(this).children('ul').hasClass('toggled')){
							$("#leftNav ul.toggled").slideToggle().removeClass('toggled');
						}
						var submenu = $(this).children('ul');
						submenu.slideToggle({
							complete: function()
							{								
								if (submenu.css('display') != 'none')
								{									
									submenu.addClass("toggled");
								}	
								else
								{
									submenu.removeClass('toggled')
								}
							}
						});
						
					}
				});
				
				$(window).resize(function(){
					clearTimeout(ResizeID);
					ResizeID = setTimeout(doneResizing, 500);							
				});
				
				
				$("#innerContentWrapper").css({
					width: ($(window).width() - 256)
				});
				
				$("a[data-dismiss]").click(function(e){
					e.preventDefault();
					$(this).parent().remove();
				});
				
				$(".submenu li").click(function(e){
					e.preventDefault();
					e.stopPropagation();
					if ($(this).children('a').attr('href') || $(this).children('span').children('a').attr('href')){
						location.href = $(this).children('a').attr('href');
					}
				});		
						
			
				$(".profilePic").click(function(){
					$(this).next().toggle();
				});
				
				$("#notifications").click(function(e){
					if ($(e.target).hasClass('notificationbar')){
						e.preventDefault();
					}
					else
					{
						$(this).children(".notificationbar").toggle();
					}
				});	

				$("#ckeditor").ckeditor();
				
				
				$(".posts.page.content #tags").on('keyup', function(e){
					var key = e.which || e.keyCode;
					if (key == 186 || key == 188)
					{
						tags(e);
					}
				});
				
				$("#calender").click(function(){
					//pops up with a calender
					$(this).calender();
				});
				
			
				
			});
			
			function doneResizing()
			{				
				$("#leftNav").css('height', ($(document).height() - 40));
					
				$("#innerContentWrapper").css({
					width: ($(window).width() - 256)
				});			
			}
		
		
		
			function tags(e)
			{
				var value = $(e.target).val();
				value = value.split(/[;,]/gi).filter(function(e) {return e});
				$.each(value, function(i, value){
					$('<span class="tags blue">'+value+'</span>').appendTo($(e.target).parent().children('.tagsEnclosure'));
				});
				$(e.target).val('');
			}
			
			$.fn.calender = function()
			{
				var Months = Array('Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec');
				var Days = Array('Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun');
				var date = new Date();
				var year = date.getFullYear()
				var actualMonth = date.getMonth();

				return this.each(function(){
					var $this = $(this);
					var calender = createCalender(this);
					calender = $(calender).appendTo('body');	

					setTimeout(function(){
						$('body').on('click', function(e){
							var target = $(e.target);
							if (!(target.parent().hasClass('calenderElement') || target.parent().parent().hasClass('calenderElement')))
							{
								calender.remove();
							}
						});
					}, 300);
				});
				
				function createCalender(elem)
				{					
					var calender = $('<div class="calenderElement"></div>').css({
						position: 'absolute',
						top: ($(elem).offset().top - ( 98 )),
						left: ($(elem).offset().left + $(elem).width() + 13),
						width: '363px',
						height: '301px',
						backgroundColor: '#fff',
						padding: '5px',
						border: '1px solid rgb(204, 204, 204)',
						boxShadow: '1px 1px 2px 0 rgba(0,0,0,0.12)'
					});
					$('<span class="ArrowSide"></span>').appendTo(calender).css({
						left: '-10px',
						width: '0',
						heigth: '0',
						top: '95px',
						position: 'absolute',	
						borderTop: '10px solid transparent',
						borderBottom: '10px solid transparent', 	
						borderRight: '10px solid #CACACA'
					});
					
					var calenderTop = $('<div class="calenderTop"></div>').appendTo(calender);
					var days = $('<div class="calenderTop"></div>').appendTo(calender).css('margin-top', '10px');
					$.each(Days, function(i, value){
						$('<span>' + value + '</span>').appendTo(days).css({
								padding: '10px',
								backgroundColor: '#eee',
								cssFloat: 'left',
								minWidth: '50px',
								textAlign: 'center'
						});
					});
					
					var calenderContent = $('<div class="calenderContent"></div>').appendTo(calender);
				
					

					$('<button class="btn">Back</button>').appendTo(calenderTop).unbind().click(function(){
						//previous month
						actualMonth--;
						monthText.text(Months[actualMonth])
						generateCalenderDates(calenderContent, elem)
					});;
					
					var monthText = $('<span class="monthCalender">Back</span>').appendTo(calenderTop).text(Months[actualMonth]).css('marginLeft', "90px");
					
					$('<button class="btn">Next</button>').appendTo(calenderTop).css("float", "right").unbind().click(function(){
						//next month
						actualMonth++;
						monthText.text(Months[actualMonth])
						generateCalenderDates(calenderContent, elem);				
					});
					
					generateCalenderDates(calenderContent, elem);				
					return calender;
				}
				
				function generateCalenderDates(calender, elem)
				{
					$(calender).empty();
					var done = false;
					for (var i = 1; i <= 31; i++)
					{	
						var dayname = new Date(year, actualMonth, 1);
						dayname = dayname.getDay() - 1;	
						if (done == false && dayname !== 0)
						{
							for (var s = 0; s < dayname; s++)
							{											                		                		
								$('<span>&#160;</span>').appendTo(calender).css({
									padding: '10px',
									backgroundColor: '#eee',
									cssFloat: 'left',
									minWidth: '50px'
								});  
							}
						}	 
						done = true;
							
						if (checkDate(i, actualMonth, year))
						{
							$('<span>'+ i +'</span>').appendTo(calender).css({
								padding: '10px',
								backgroundColor: '#eee',
								cssFloat: 'left',
								minWidth: '50px',
								textAlign: 'center',
								cursor: 'pointer'
							}).hover(function(){
								$(this).css({
									backgroundColor: "#D4D0D0"
								});
							}, function()
							{
								$(this).css({
									backgroundColor: "#eee"
								});
							}).click(function(){
								actualMonth++;
								var currentDateString = ($(this).text() > 9 ?  $(this).text() : ('0' + $(this).text())) + '-' + (actualMonth > 9 ?  actualMonth : ('0' + actualMonth)) + '-' + year;
								$(elem).val(currentDateString);
								$(calender).parent().remove();
							});
						}	
					}
				}
				
				function checkDate(day, month, year)
				{					
					console.log(month, year);
					var Newdate = new Date(year, month, day);
					if (Newdate.getMonth() == month && Newdate.getDate() == day){
						return true;
					} else {
						return false;
					}
				}
			};
		</script>	
	</head>
	<body>
		<nav id="top">
			<div id="rightcontrols">
				<div id="search">
					<form class="navbar-form">
						<div class="form-group">
							<input type="text" placeholder="Search..." />
						</div>
					</form>
				</div>
				<div id="notifications">
					<span class="icon notifications"></span>
					<span class="badge">5</span>
					<div class="notificationbar">
						
					
					</div>
				</div>
				<div id="person">
					<div class="profilePic dark">
						<img src="userfiles/rsz_chrysanthemum-32.jpg" />
						<span> username </span>
						<span class="caret"></span>						
					</div>
					<ul class="dropdown"> 
						<li>
							<a href="#" class="noUnderLine">
								<img src="userfiles/rsz_chrysanthemum.jpg" />
								<span> Username </span>
							</a>
						</li>
						<li>
							<a href="#"> Edit My Profile </a>						
						</li> 
						<li>
							<a href="#"> Log Out </a>						
						<li> 
					</ul>
				</div>				
			</div>
			<div class="menu menu-expand toggle btn">
				<i class="icon-reorder"></i> 
			</div>
		</nav>
		<div id="mainContent">
			<div id="leftNav">
				<ul>
					<li>
						<i class="icon-dashboard"></i>
						<span><a href="index.html">Dashboard</a></span>
					</li>
					<li>
						<i class="icon-pushpin"></i>
						<span> 
							Post's 
							<i class="icon-angle-down angle-down icon-right"></i>
						</span>
						<ul class="submenu" >
							<li  class="selected dark">
								<a href="#"> All posts </a>
							</li>							
							<li>
								<a href="#"> Add New </a>
							</li>							
							<li>
								<a href="#"> Categories </a>
							</li>
							<li>
								<a href="#"> Tags </a>
							</li>
							
							
						</ul>
					</li>
					<li>
						<i class="icon-group"></i>
						<span> 
							Users 
							<i class="icon-angle-down angle-down icon-right"></i>
						</span>
						
						<ul class="submenu">
							<li>
								<a href="users.html"> All users </a>
							</li>							
							<li>
								<a href="#"> Edit New </a>
							</li>								
						</ul>
					</li>
			
			</div>
		
		
		</div>	
			<div id="mainHeader">
				<div class="header">
					<i class="icon-file  red"></i>
					<h2> Create a post </h2>
				</div>
			</div>
			<section id="innerContentWrapper" class="float left">
				<div id="innerContent" class="posts page content">
					<div class="user alert alert-dismissable alert-info"> 
						<a class="close" data-dismiss="alert" href="#">x</a>
						If you want to put a date in or it will get submited to queue Instantly
					</div>
					<textarea id="ckeditor"></textarea>
					<div class="tags">
						<span class="tagsEnclosure"></span>
						<input type="text" id="tags" />
					</div>
					<div id="submitDate">
						<p> What date do you want to submit it? </p>
						<input type="text" id="calender"/>
					</div>
				</div>	
				<span class="line break block clearfix"></span>
			</section>			
			<footer>
				<span class="thanks">
					<p> Thanks For building :) </p>
				</span>
			</footer>		
	</body>
</html>